
    <script>
      var map;
      var markers     = <%= @locations.to_json.html_safe %>;
      var objectives  = <%= @trip.objectives.to_json.html_safe %>;

      function initMap() {
        var myLatLng = {lat: -34.397, lng: 150.644} 

        map = new google.maps.Map(document.getElementById('map'), {
          center: markers[0],
          zoom: 8
        });

        var infowindow = new google.maps.InfoWindow(), marker, i;
        var bounds = new google.maps.LatLngBounds();

        for (i = 0; i < markers.length; i++) {  
            marker = new google.maps.Marker({
                position: markers[i],
                map: map
            });
            
            // extending a bounds range per marker 
            bounds.extend(marker.position);

            google.maps.event.addListener(marker, 'click', (function(marker, i) {
                return function() {
                    infowindow.setContent(objectives[i].title);
                    infowindow.open(map, marker);
                }
            })(marker, i));
        }

        // Fitting map to bounds
        map.fitBounds(bounds);

        var listener = google.maps.event.addListener(map, "idle", function () {
            map.setZoom(6);
            google.maps.event.removeListener(listener);
        });

      }


    </script>
   <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6bIdRiDEVfRxawlb_b2-VUwhdrNy7ZZA&callback=initMap"
    async defer></script>
  

  <!-- Add Div to body -->
<div id="map" style="width:500px;height:380px;"></div>




<h1><%= @trip.title %></h1>

<% if @trip.objectives.blank? %>
  <li><%= link_to "Create New Objective", new_objective_path %></li>
<% end %>  
  <ul>
  <% @trip.objectives.each do |objective| %>
    <li><h4><%= link_to objective.title, trip_objective_path(objective.trip, objective) %></h4></li>
    <li><%= objective.city    %></li>
    <li><%= objective.state   %></li>
    <li><%= objective.country %></li>
    <li><%= objective.notes   %></li>
    <li><%= link_to "Edit this objective", edit_trip_objective_path(objective) %></li>
    <br>
  <% end %>
  </ul>

<%= render 'layouts/links' %>




