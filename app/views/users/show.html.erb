<div class="well">
  <div class="col-lg-6">
    <h2>Profile:</h2>
    <% if current_user %>
      <h4>Name: <%= current_user.name  %><h4>
      <p>Email: <%= current_user.email %></p>
      <br>
      <p><small>View a trip and add objectives!</small></p>
      <a class="btn btn-lg btn-primary" id="trips" role="button">Trips:</a>
      <a id="trip-objectives" role="button"></a>
      <div id="mo-trips"></div>
    <% end %>
  </div>
</div>

<script type="text/javascript" charset='utf-8'>
  $(function() {
    $("#trips").click(function() {
      var id = <%= current_user.id %>;
      // populating button for trip objectives
      $('#trip-objectives').attr('class', 'btn btn-lg btn-primary');
      $('#trip-objectives').text('Trip Objectives:');
      
      $.ajax({
        dataType: 'json',
        url: "/trips",
        method: 'GET',
        success: function(data) {
          $.each(data, function(index,key) {

            var id           = data[index].id;
            // the variable below did not let me interpolate id so I had to manually do it
            var deleteButton = '<%= button_to "Delete Trip", { controller: :trips ,action: "destroy", id: '' }, method: :delete, data: { confirm: "Are you sure?" } %>';

            $('#mo-trips').append('<h4><a href=/trips/'+data[index].id+'>'+data[index].title+'</a></h4><li>'+data[index].description+'</li><br>'+deleteButton);

            // below I interpolate that id to the button action
            $('form:eq('+index+')').removeAttr('action');
            $('form:eq('+index+')').attr('action', '/trips/'+id);

          });
        }
      });
    })
  });

</script>

<%= render 'layouts/links' %>